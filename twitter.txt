Function OpenAndHighlightExcel(filePath)
    On Error Resume Next

    Dim xlApp, wb, ws, lastRow, cell, fso

    ' Check if file exists
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FileExists(filePath) Then
        MsgBox "File not found: " & filePath, vbCritical
        Exit Function
    End If

    ' Start Excel
    Set xlApp = CreateObject("Excel.Application")
    If xlApp Is Nothing Then
        MsgBox "Excel could not be started.", vbCritical
        Exit Function
    End If

    xlApp.Visible = True ' Show Excel to the user

    ' Open workbook
    Set wb = xlApp.Workbooks.Open(filePath)
    If wb Is Nothing Then
        MsgBox "Failed to open the workbook.", vbCritical
        xlApp.Quit
        Exit Function
    End If

    ' Use first sheet
    Set ws = wb.Sheets(1)

    ' Find last row in column L
    lastRow = ws.Cells(ws.Rows.Count, "L").End(-4162).Row ' -4162 = xlUp

    ' Loop from L2 to lastRow and highlight if time > 16:00
    For Each cell In ws.Range("L2:L" & lastRow)
        If IsDate(cell.Value) Then
            If TimeValue(cell.Value) > TimeValue("16:00") Then
                cell.Interior.Color = RGB(255, 255, 0) ' Yellow
            End If
        End If
    Next

    ' Clean up (Excel remains open)
    Set fso = Nothing
    Set cell = Nothing
    Set ws = Nothing
    Set wb = Nothing
    Set xlApp = Nothing

    MsgBox "Highlighting complete for times greater than 16:00.", vbInformation
End Function

' âœ… Example usage
Call OpenAndHighlightExcel("C:\Users\YourName\Desktop\yourfile.xlsx")
