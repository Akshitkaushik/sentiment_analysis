Function HighlightPostTimeGreaterThan4PM(filePath)
    On Error Resume Next

    Dim xlApp, wb, ws, lastRow, i, cell

    ' Create Excel application
    Set xlApp = CreateObject("Excel.Application")
    If xlApp Is Nothing Then
        MsgBox "Failed to create Excel application.", 16
        Exit Function
    End If

    xlApp.Visible = True

    ' Open the workbook
    Set wb = xlApp.Workbooks.Open(filePath)
    If wb Is Nothing Then
        MsgBox "Failed to open file: " & filePath, 16
        Exit Function
    End If

    Set ws = wb.Sheets(1)

    ' Get last row in column L
    lastRow = ws.Cells(ws.Rows.Count, "L").End(-4162).Row ' -4162 = xlUp

    ' Loop through column L and highlight full row if value > 4 PM
    For i = 2 To lastRow
        Set cell = ws.Cells(i, 12) ' Column L = 12
        If IsNumeric(cell.Value) Then
            If cell.Value > 0.6666667 Then ' 4:00 PM as decimal
                cell.EntireRow.Interior.Color = RGB(255, 255, 0)
            End If
        End If
    Next

    MsgBox "Highlighting complete for Post Time > 16:00.", 64

    ' Clean up
    Set cell = Nothing
    Set ws = Nothing
    Set wb = Nothing
    Set xlApp = Nothing
End Function

' âœ… Example usage
Call HighlightPostTimeGreaterThan4PM("C:\Users\YourName\Desktop\yourfile.xlsx")
