Function HighlightPostTimeAbove16(filePath)
    On Error Resume Next

    Dim xlApp, wb, ws, lastRow, cell
    Set xlApp = CreateObject("Excel.Application")
    If Err.Number <> 0 Then
        MsgBox "Excel application could not be started.", vbCritical
        Exit Function
    End If

    xlApp.Visible = False
    Set wb = xlApp.Workbooks.Open(filePath)
    If Err.Number <> 0 Then
        MsgBox "Failed to open file: " & filePath, vbCritical
        xlApp.Quit
        Exit Function
    End If

    Set ws = wb.Sheets(1)

    lastRow = ws.Cells(ws.Rows.Count, "L").End(-4162).Row ' xlUp = -4162

    For Each cell In ws.Range("L2:L" & lastRow)
        If IsDate(cell.Value) Then
            If TimeValue(cell.Value) > TimeValue("16:00") Then
                cell.Interior.Color = RGB(255, 255, 0) ' Yellow
            End If
        End If
    Next

    wb.Save
    wb.Close False
    xlApp.Quit

    Set cell = Nothing
    Set ws = Nothing
    Set wb = Nothing
    Set xlApp = Nothing

    MsgBox "Highlighting complete for times > 16:00", vbInformation
End Function
