Function OpenAndHighlightExcel(filePath)
    On Error Resume Next

    Dim xlApp, wb, ws, lastRow, cell, fso

    ' Check if file exists
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FileExists(filePath) Then
        MsgBox "File not found: " & filePath, vbCritical
        Exit Function
    End If

    ' Launch Excel
    Set xlApp = CreateObject("Excel.Application")
    If xlApp Is Nothing Then
        MsgBox "Excel could not be started.", vbCritical
        Exit Function
    End If

    xlApp.Visible = True

    ' Open workbook
    Set wb = xlApp.Workbooks.Open(filePath)
    If wb Is Nothing Then
        MsgBox "Unable to open workbook.", vbCritical
        xlApp.Quit
        Exit Function
    End If

    Set ws = wb.Sheets(1)

    ' Find last row in column L
    lastRow = ws.Cells(ws.Rows.Count, "L").End(-4162).Row ' xlUp

    ' Loop through cells in L2 to last row
    For Each cell In ws.Range("L2:L" & lastRow)
        If IsNumeric(cell.Value) Then
            ' Excel stores 16:00 as 0.6666667
            If cell.Value > 0.6666667 Then
                cell.Interior.Color = RGB(255, 255, 0) ' Yellow
            End If
        End If
    Next

    ' Clean up
    Set fso = Nothing
    Set cell = Nothing
    Set ws = Nothing
    Set wb = Nothing
    Set xlApp = Nothing

    MsgBox "Done: Highlighted all Post Times after 16:00.", vbInformation
End Function

' Example usage
Call OpenAndHighlightExcel("C:\Users\YourName\Desktop\yourfile.xlsx")
