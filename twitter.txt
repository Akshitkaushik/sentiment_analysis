Function OpenExcelFile(filePath)
    On Error Resume Next

    Dim xlApp, wb

    ' Check if file exists
    Dim fso
    Set fso = CreateObject("Scripting.FileSystemObject")
    If Not fso.FileExists(filePath) Then
        MsgBox "File not found: " & filePath, vbCritical
        Exit Function
    End If

    ' Start Excel
    Set xlApp = CreateObject("Excel.Application")
    If xlApp Is Nothing Then
        MsgBox "Excel could not be started.", vbCritical
        Exit Function
    End If

    xlApp.Visible = True ' Show Excel to the user

    ' Open Workbook
    Set wb = xlApp.Workbooks.Open(filePath)
    If wb Is Nothing Then
        MsgBox "Failed to open the workbook.", vbCritical
    End If

    ' Clean up
    Set fso = Nothing
    Set wb = Nothing
    Set xlApp = Nothing
End Function

' Example usage
Call OpenExcelFile("C:\Users\YourName\Desktop\yourfile.xlsx")
